<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%> <%	String path = request.getContextPath();	String basePath = request.getScheme() + "://"			+ request.getServerName() + ":" + request.getServerPort()			+ path + "/"; %><%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%><%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%><!DOCTYPE html><html>  <head>    <c:choose>    	<c:when test="${user.userTypeId==4}">    		<title>${loginBean.eName} - Visa</title>    	</c:when>    	<c:otherwise><title>${loginBean.cName} - 签证</title></c:otherwise>    </c:choose>    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport" />    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />    <base href="<%=basePath%>" />  </head>  <body class="contrast-red">    <%@ include file="/common/res.jsp" %>    <!-- 引入header头部 -->    <%@ include file="/common/header.jsp" %>     <div id="wrapper">      <!-- 引入左侧导航栏 -->      <%@ include file="/common/nav.jsp" %>      <section id="content">        <div class="container-fluid">          <div class="row-fluid" id="content-wrapper">            <div class="span12">              <div class="page-header">                <h1 class="pull-left">                  <i class="icon-print"></i>                  <span>签证即将到期学生</span>                </h1>              </div>              <div class="row-fluid">                <div class="span12">                  <div class="alert alert-info">                    <i class="icon-info-sign"></i>                    签证到期前30天将会自动对学生发起签证即将到期的通知                  </div>                </div>              </div>                           <c:if test="${user.userTypeId==1 or user.userTypeId==2}">              <div class="row-fluid" id="sift">                <div class="span12 box">                  <div class="box-header blue-background">                    <div class="title">                      <div class="icon-user"></div>                      <b>筛选</b>                    </div>                    <div class="actions">                      <a href="#" class="btn box-collapse btn-mini btn-link"><i></i></a>                    </div>                  </div>                  <div class="box-content">                    <form id="" accept-charset="UTF-8" action="${pageContext.request.contextPath}/visa.html" class="form form-horizontal" method="post" style="margin-bottom: 0;" />                    <div style="margin:0;padding:0;display:inline">                    <input name="type" type="hidden" value="search" />                    <input name="page" type="hidden" value="0" />                    </div>                      <div class="control-group">                        <label class="control-label" for="inputSelect">选择学院</label>                        <div class="controls">                          <select id="" name="academyId" class='select2 input-block-level' style="width: 216px;">                            <c:forEach items="${academyMap}" var="academy">                              <option value="${academy.key}">${academy.value.cName}</option>                            </c:forEach>                          </select>                        </div>                      </div>                      <div class="control-group">                        <label class="control-label" for="inputSelect">选择专业</label>                        <div class="controls">                          <select id="" name="majorId" class='select2 input-block-level' style="width: 216px;">                            <c:forEach items="${majorMap}" var="major">                              <option value="${major.key}">${major.value.majorChineseName}</option>                            </c:forEach>                            </option>                          </select>                        </div>                      </div>                      <div class="control-group">                        <label class="control-label" for="inputSelect">选择班级</label>                        <div class="controls">                          <select id="" name="cclassId" class='select2 input-block-level' style="width: 216px;">                            <c:forEach items="${classMap}" var="amc">                             <option value="${amc.value.cclass.classId}">${amc.value.cclass.cName}</option>                            </c:forEach>                          </select>                        </div>                      </div>                      <div class="control-group">                        <label class="control-label" for="inputSelect">学年</label>                        <div class="controls">                          <select id="" name="schoolYear" class='select2 input-block-level' style="width: 216px;">                            <option value="2017-2018">2017-2018</option>                            <option value="2018-2019">2018-2019</option>                            <option value="2020-2021">2020-2021</option>                            <option value="2011-2022">2011-2022</option>                            <option value="2022-2023">2022-2023</option>                            <option value="2023-2024">2023-2024</option>                            <option value="2024-2025">2024-2025</option>                          </select>                        </div>                      </div>                      <div class="control-group">                        <label class="control-label">学期</label>                        <div class="controls">                          <label class="checkbox inline">                            <input type="checkbox" name="theSemester" value="1" class="moneySrc">                            <span>第一学期</span>                          </label>                          <label class="checkbox inline">                            <input type="checkbox" name="theSemester" value="2" class="moneySrc">                            <span>第二学期</span>                          </label>                        </div>                      </div>                      <hr class='hr-normal' />                      <div class="control-group">                        <div class="controls">                          <button class="btnNisal" style="margin: 0px;" type="submit" id="">查询</button>                        </div>                      </div>                    </form>                  </div>                </div>                <hr class="hr-double" />              </div>              </c:if>                            <div class="row-fluid">                <div class="span12 box bordered-box orange-border" style="margin-bottom:0;">                  <div class="box-header purple-background">                    <div class="title">                    <c:choose>                     <c:when test="${user.userTypeId==4}">                      <b>Students' List</b>                     </c:when>                     <c:otherwise>                      <b>学生列表</b>                     </c:otherwise>                    </c:choose>                                        </div>                    <div class="actions">                      <a href="#" class="btn box-collapse btn-mini btn-link"><i></i></a>                    </div>                  </div>                  <div class="box-content box-no-padding">                    <div class="responsive-table">                      <div class="scrollable-area">                        <table class="data-table table table-bordered table-striped" style="margin-bottom:0;">                          <thead>                          <c:choose>                           <c:when test="${user.userTypeId==1 or user.userTypeId==2}">                            <tr>                              <th>姓名</th>                              <th>当前学期</th>                              <th>护照号</th>                              <th>到期日期</th>                              <th>联系方式</th>                              <th>应缴金额</th>                              <th>已交金额</th>                            </tr>                           </c:when>                                                      <c:otherwise>                            <tr>                              <th>Name</th>                              <th>Year</th>                              <th>Passport Number</th>                              <th>Due Date</th>                              <th>Phone Number</th>                              <th>Needs to pay</th>                              <th>Paid</th>                            </tr>                           </c:otherwise>                          </c:choose>                          </thead>                          <tbody>                          <c:forEach items="${visaForms}" var="visaForm">                           <tr>                              <td class=""><a href="${pageContext.request.contextPath}/studentInfo.html?type=init&id=${visaForm.user.userId}" target="_blank">${visaForm.user.fullName}</a></td>                              <td>${visaForm.payment.schoolYear} 第${visaForm.payment.theSemester}学期</td>                              <td></td>                              <td>${visaForm.visaOnUser.visa.visaDueDate}</td>                              <td>${visaForm.user.phone}</td>                              <td>${visaForm.payment.totalMoney}</td>                              <td>${visaForm.payment.money}</td>                            </tr>                          </c:forEach>                          </tbody>                        </table>                      </div>                    </div>                  </div>                  <div class="paging">                    <a class="prev" href="">上一页</a>                    <a class="next" href="">下一页</a>                    <input onkeydown="onlyNum();" type="text" name="" value="" placeholder="页码">                    <span class="nowPage">1</span>/<span class="maxPage">1</span>                    <a class="trun" href="">跳转</a>                  </div>                </div>              </div>            </div>          </div>        </div>      </section>    </div>    <script>      var nowPage = parseInt($(".nowPage").html());      $(".prev").click(function(){        if(nowPage <= 1){          layer.msg("已经是第一页了");          return false;        }         window.location.href = window.location.href.replace(/\d{1,}$/g, nowPage - 1);      });      $(".next").click(function(){        if(nowPage >= parseInt($(".maxPage").html())){          layer.msg("已经是最后一页了");          return false;        }         window.location.href = window.location.href.replace(/\d{1,}$/g, nowPage + 1);      });      function onlyNum() {        if(!(event.keyCode==46)&&!(event.keyCode==8)&&!(event.keyCode==37)&&!(event.keyCode==39))        if(!((event.keyCode>=48&&event.keyCode<=57)||(event.keyCode>=96&&event.keyCode<=105)))        event.returnValue=false;      }      $(document).ready(function(){        $(".update").click(function(){          layer.msg("<span style='font-size: 18px;'>请到学生信息详情页修改学生详细信息</span>");        });        $(".paging .trun").click(function(){          var page = $(".paging input").val();          if(page === ""){            layer.msg("请填入页码");            return false;          }          var link = window.location.href;          var src  = link.replace(/\d{1,}$/g, page);          window.location.href = src;          return false;        });      });    </script>      </body></html>